2023-01-25 09:43:36.886519: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2023-01-25 09:43:42.930789: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-01-25 09:43:42.933046: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2023-01-25 09:43:43.263630: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce GTX 1080 Ti computeCapability: 6.1
coreClock: 1.6705GHz coreCount: 28 deviceMemorySize: 10.91GiB deviceMemoryBandwidth: 451.17GiB/s
2023-01-25 09:43:43.264213: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 1 with properties: 
pciBusID: 0000:02:00.0 name: GeForce GTX 1080 Ti computeCapability: 6.1
coreClock: 1.6705GHz coreCount: 28 deviceMemorySize: 10.92GiB deviceMemoryBandwidth: 451.17GiB/s
2023-01-25 09:43:43.264234: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2023-01-25 09:43:43.267332: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2023-01-25 09:43:43.267367: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2023-01-25 09:43:43.269475: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2023-01-25 09:43:43.270689: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2023-01-25 09:43:43.273166: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2023-01-25 09:43:43.276141: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2023-01-25 09:43:43.280236: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2023-01-25 09:43:43.283162: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0, 1
2023-01-25 09:43:43.283198: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2023-01-25 09:43:43.941507: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2023-01-25 09:43:43.941539: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 1 
2023-01-25 09:43:43.941545: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N Y 
2023-01-25 09:43:43.941548: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 1:   Y N 
2023-01-25 09:43:43.943762: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:0 with 10251 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0, compute capability: 6.1)
2023-01-25 09:43:43.945092: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/device:GPU:1 with 10269 MB memory) -> physical GPU (device: 1, name: GeForce GTX 1080 Ti, pci bus id: 0000:02:00.0, compute capability: 6.1)
2023-01-25 09:43:43.945314: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2023-01-25 09:43:45.619816: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2023-01-25 09:43:45.620628: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce GTX 1080 Ti computeCapability: 6.1
coreClock: 1.6705GHz coreCount: 28 deviceMemorySize: 10.91GiB deviceMemoryBandwidth: 451.17GiB/s
2023-01-25 09:43:45.621213: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 1 with properties: 
pciBusID: 0000:02:00.0 name: GeForce GTX 1080 Ti computeCapability: 6.1
coreClock: 1.6705GHz coreCount: 28 deviceMemorySize: 10.92GiB deviceMemoryBandwidth: 451.17GiB/s
2023-01-25 09:43:45.621234: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2023-01-25 09:43:45.621262: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2023-01-25 09:43:45.621275: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2023-01-25 09:43:45.621286: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2023-01-25 09:43:45.621297: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2023-01-25 09:43:45.621308: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2023-01-25 09:43:45.621319: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2023-01-25 09:43:45.621331: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2023-01-25 09:43:45.623548: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0, 1
2023-01-25 09:43:45.628514: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce GTX 1080 Ti computeCapability: 6.1
coreClock: 1.6705GHz coreCount: 28 deviceMemorySize: 10.91GiB deviceMemoryBandwidth: 451.17GiB/s
2023-01-25 09:43:45.629091: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 1 with properties: 
pciBusID: 0000:02:00.0 name: GeForce GTX 1080 Ti computeCapability: 6.1
coreClock: 1.6705GHz coreCount: 28 deviceMemorySize: 10.92GiB deviceMemoryBandwidth: 451.17GiB/s
2023-01-25 09:43:45.629107: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
2023-01-25 09:43:45.629121: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
2023-01-25 09:43:45.629133: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.10
2023-01-25 09:43:45.629144: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2023-01-25 09:43:45.629155: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2023-01-25 09:43:45.629165: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2023-01-25 09:43:45.629176: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.10
2023-01-25 09:43:45.629186: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.7
2023-01-25 09:43:45.631350: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0, 1
2023-01-25 09:43:45.631388: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2023-01-25 09:43:45.631395: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 1 
2023-01-25 09:43:45.631399: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N Y 
2023-01-25 09:43:45.631403: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 1:   Y N 
2023-01-25 09:43:45.633146: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10251 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:01:00.0, compute capability: 6.1)
2023-01-25 09:43:45.633723: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 10269 MB memory) -> physical GPU (device: 1, name: GeForce GTX 1080 Ti, pci bus id: 0000:02:00.0, compute capability: 6.1)
2023-01-25 09:43:45.633740: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
/home/smghames/anaconda3/envs/qtc_predict/lib/python3.9/site-packages/tensorflow/python/keras/layers/legacy_rnn/rnn_cell_impl.py:903: UserWarning: `tf.nn.rnn_cell.LSTMCell` is deprecated and will be removed in a future version. This class is equivalent as `tf.keras.layers.LSTMCell`, and will be replaced by that in Tensorflow 2.0.
  warnings.warn("`tf.nn.rnn_cell.LSTMCell` is deprecated and will be "
/home/smghames/anaconda3/envs/qtc_predict/lib/python3.9/site-packages/tensorflow/python/keras/legacy_tf_layers/core.py:171: UserWarning: `tf.layers.dense` is deprecated and will be removed in a future version. Please use `tf.keras.layers.Dense` instead.
  warnings.warn('`tf.layers.dense` is deprecated and '
/home/smghames/anaconda3/envs/qtc_predict/lib/python3.9/site-packages/tensorflow/python/keras/engine/base_layer_v1.py:1719: UserWarning: `layer.apply` is deprecated and will be removed in a future version. Please use `layer.__call__` method instead.
  warnings.warn('`layer.apply` is deprecated and '
/home/smghames/anaconda3/envs/qtc_predict/lib/python3.9/site-packages/tensorflow/python/keras/engine/base_layer_v1.py:1727: UserWarning: `layer.add_variable` is deprecated and will be removed in a future version. Please use `layer.add_weight` method instead.
  warnings.warn('`layer.add_variable` is deprecated and '
WARNING:tensorflow:From /home/smghames/anaconda3/envs/qtc_predict/lib/python3.9/site-packages/tensorflow/python/keras/layers/legacy_rnn/rnn_cell_impl.py:981: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
W0125 09:43:48.134803 139823822874368 deprecation.py:531] From /home/smghames/anaconda3/envs/qtc_predict/lib/python3.9/site-packages/tensorflow/python/keras/layers/legacy_rnn/rnn_cell_impl.py:981: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
2023-01-25 09:43:59.728578: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:196] None of the MLIR optimization passes are enabled (registered 0 passes)
2023-01-25 09:44:00.125652: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 3597805000 Hz
2023-01-25 09:44:13.863492: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.10
GPU found
True
Using TensorFlow version 2.4.1
GPU available: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU'), PhysicalDevice(name='/physical_device:GPU:1', device_type='GPU')]
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
get dataset X_T shape= (63788, 27, 5)
get_datasets y_T shape= (60865, 84, 1)
train size =  51030
val size =  6378
---------------------Finished zipping data in tf dataset structure ----------------------------------------
dataset get shuffled
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols1 in shape= 27
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols2 in shape= 1
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
cols3 in shape= 27
get dataset X_T shape= (63788, 27, 5)
get_datasets y_T shape= (60865, 84, 1)
train size =  51030
val size =  6378
---------------------Finished zipping data in tf dataset structure ----------------------------------------
dataset get shuffled
 inp att enabled ===================================================== 
 _attention_enc() ===================================================== 
alpha shape = (5, 54, 1)
input shape = (5, 54, 5)
 inp att enabled ===================================================== 
 _attention_enc() ===================================================== 
alpha shape = (5, 54, 1)
input shape = (5, 54, 5)
 inp att enabled ===================================================== 
 _attention_enc() ===================================================== 
alpha shape = (5, 54, 1)
input shape = (5, 54, 5)
 inp att enabled ===================================================== 
 _attention_enc() ===================================================== 
alpha shape = (5, 54, 1)
input shape = (5, 54, 5)
 inp att enabled ===================================================== 
 _attention_enc() ===================================================== 
alpha shape = (5, 54, 1)
input shape = (5, 54, 5)
encoder outputs shape= (5, 5, 256)
 temp att enabled ===================================================== 
 _attention ===================================================== 
 temp att enabled ===================================================== 
 _attention ===================================================== 
 temp att enabled ===================================================== 
 _attention ===================================================== 
 temp att enabled ===================================================== 
 _attention ===================================================== 
 temp att enabled ===================================================== 
 _attention ===================================================== 
d_c shape= (5, 512)
y_T shape= (5, 2)
y_Ts shape = (5, 80, 2)
time series cross entropy loss= (5, 80)
====================================== MODEL INIT ======================================
==================================================Test==================================================
nb batches in val= 691
evaluate loss shape=  ()
----------------------
RMSE: 3.72865
MAE: 2.16611
MAPE: inf
ADE: 3.06784
AFDE: 3.05411
DE-STD: 5.45483
FDE-STD: 5.55937
best_RMSE=3.72865
